---
title: "Interactive Census Map"
author: "Matt Khinda"
date: "10/12/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r setup, include = FALSE}
library(tidycensus)
library(leaflet)
library(sf)
library(tidyverse)
library(ggthemes)
library(ggspatial)
library(htmlwidgets)
library(tidytransit)
```

```{r exploring variables, include = FALSE}
v19 <- load_variables(2019, "acs5", cache = TRUE)
View(v19)

```

```{r interactive map, echo=FALSE}
USA_tenure <- get_acs(geography = "county", 
                           year = 2019, survey = "acs5",
                           variables = c(tot_units = "B25003_001", tot_owner = "B25003_002", tot_renter = "B25003_003"),
                           output = "wide", geometry = TRUE) 

USA_tenure <- USA_tenure %>%
  select(-tot_ownerM, -tot_renterM, - tot_unitsM) %>%
  mutate(pct_tenurediff = round((tot_ownerE - tot_renterE)/(tot_ownerE + tot_renterE)*100, 1))

USA_tenure_palette <- colorNumeric(c("pink", "lightblue"),USA_tenure$pct_tenurediff)

USA_tenure_map <- leaflet(USA_tenure) %>%
  addProviderTiles("Stamen.TonerLite") %>%
  addPolygons(stroke = FALSE, fillOpacity = 0.7,
    color = ~USA_tenure_palette(pct_tenurediff))

USA_tenure_map

```

```{r interactive map, echo=FALSE}
LA_tenure <- get_acs(geography = "tract", county = c("Los Angeles", "Ventura", "Orange"), state = "CA", 
                           year = 2019, survey = "acs5",
                           variables = c(tot_units = "B25003_001", tot_owner = "B25003_002", tot_renter = "B25003_003"),
                           output = "wide", geometry = TRUE) 

LA_tenure <- LA_tenure %>%
  select(-tot_ownerM, -tot_renterM, - tot_unitsM) %>%
  mutate(pct_tenurediff = round((tot_ownerE - tot_renterE)/(tot_ownerE + tot_renterE)*100, 1))

LA_tenure_palette <- colorNumeric(c("pink", "lightblue"),LA_tenure$pct_tenurediff)

LA_tenure_map <- leaflet(LA_tenure) %>%
  addProviderTiles("Stamen.TonerLite") %>%
  addPolygons(stroke = FALSE, fillOpacity = 0.7,
    color = ~LA_tenure_palette(pct_tenurediff))

LA_tenure_map

```


